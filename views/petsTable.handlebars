{{#section 'style'}}
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs-3.3.7/jq-2.2.4/jszip-3.1.3/pdfmake-0.1.27/dt-1.10.15/af-2.2.0/b-1.3.1/b-colvis-1.3.1/b-flash-1.3.1/b-html5-1.3.1/b-print-1.3.1/cr-1.3.3/fc-3.2.2/fh-3.1.2/kt-2.2.1/r-2.1.1/rg-1.0.0/rr-1.2.0/sc-1.4.2/se-1.2.2/datatables.min.css"/>
<link rel="stylesheet" type="text/css" href="/assets/editor/css/editor.dataTables.css">
{{/section}}
<div class="row">
    <div class="col-md-12">
<table id="petsDash" class="display" cellspacing="0" width="100%">
		<thead>
				<tr>
                    <th>Selected</th>
                    <th>ID</th>
                    <th>ownerId</th> 
                    <th>pet_name</th> 
                    <th>pet_type</th> 
                    <th>pet_breed</th> 
                    <th>pet_color</th> 
                    <th>license_no</th> 
                    <th>microchip_no</th> 
                    <th>insur_name</th> 
                    <th>insur_id</th> 
                    <th>insur_phone</th> 
                    <th>pet_dob</th> 
                    <th>pet_dod</th> 
                    <th>pet_age</th> 
                    <th>pet_sex</th> 
                    <th>spayed_neutered_ind</th> 
                    <th>pet_image_url</th> 
                    <th>cond1</th> 
                    <th>cond2</th> 
                    <th>cond3</th> 
                    <th>med1</th> 
                    <th>med2</th> 
                    <th>med3</th> 
                    <th>vet1_name</th> 
                    <th>vet1_specialty</th> 
                    <th>vet1_address</th> 
                    <th>vet1_city</th> 
                    <th>vet1_state</th> 
                    <th>vet1_zip</th> 
                    <th>vet1_phone</th> 
                    <th>vet1_email</th> 
                    <th>vet1_fax</th> 
                    <th>vet2_name</th> 
                    <th>vet2_specialty</th> 
                    <th>vet2_address</th> 
                    <th>vet2_city</th> 
                    <th>vet2_state</th> 
                    <th>vet2_zip</th> 
                    <th>vet2_phone</th> 
                    <th>vet2_email</th> 
                    <th>vet2_fax</th> 
                    <th>createdAt</th> 
                    <th>updatedAt</th>
                    <th>Edit / Delete</th>
				</tr>
		</thead>
	</table>
    </div>
</div>
{{#section 'script'}}
<script type="text/javascript" src="https://cdn.datatables.net/v/bs-3.3.7/jq-2.2.4/jszip-3.1.3/pdfmake-0.1.27/dt-1.10.15/af-2.2.0/b-1.3.1/b-colvis-1.3.1/b-flash-1.3.1/b-html5-1.3.1/b-print-1.3.1/cr-1.3.3/fc-3.2.2/fh-3.1.2/kt-2.2.1/r-2.1.1/rg-1.0.0/rr-1.2.0/sc-1.4.2/se-1.2.2/datatables.min.js"></script>
<script type="text/javascript" src="/assets/editor/js/dataTables.editor.js"></script>
<script type="text/javascript" src="//cdn.datatables.net/plug-ins/1.10.15/api/fnReloadAjax.js"></script>
<script>
   

$(document).ready(function() {
    

    var editor = new $.fn.dataTable.Editor( {} );

    editor = new $.fn.dataTable.Editor( {
         ajax: {
                create: {
                    type: 'POST',
                    url: '/api/pet',
                    "complete": function(response) {
                        // Update the draw element in the DOM
                        table.ajax.reload();
                    }
                },
                edit: {
                    type: 'PUT',
                    url: '/api/pet',
                    "success": function(response) {
                        // Update the draw element in the DOM
                        table.ajax.reload();
                    }
                },
                remove:{
                    type:'DELETE',
                    url:'/api/pet',
                    contentType: 'application/json',
                    data: function ( data ) {
                        /*return {"id": JSON.stringify(data.data[Object.keys(data.data)].id)};*/
                        return {"ids": Object.keys(data.data)};
                    },
                    "success": function(response) {
                        // Update the draw element in the DOM
                        table.ajax.reload();
                    }
                },
            },
            idSrc:'id',
        table: '#petsDash',
        
        fields: [
            {label: 'id', name: 'id'},
            {label: "ownerId", name: "ownerId"},
            {label: "pet_name", name: "pet_name"},
            {label: "pet_type", name: "pet_type"},
            {label: "pet_breed", name: "pet_breed"},
            {label: "pet_color", name: "pet_color"},
            {label: "license_no", name: "license_no"},
            {label: "microchip_no", name:"microchip_no"},
            {label: "insur_name", name:"insur_name"},
            {label: "insur_id", name:"insur_id"},
            {label: "insur_phone", name:"insur_phone"},
            {label: "pet_dob", name:"pet_dob"},
            {label: "pet_dod", name:"pet_dod"},
            {label: "pet_age", name:"pet_age"},
            {label: "pet_sex", name:"pet_sex"},
            {label: "spayed_neutered_ind", name:"spayed_neutered_ind"},
            {label: "pet_image_url", name:"pet_image_url"},
            {label: "cond1", name:"cond1"},
            {label: "cond2", name:"cond2"},
            {label: "cond3", name:"cond3"},
            {label: "med1", name:"med1"},
            {label: "med2", name:"med2"},
            {label: "med3", name:"med3"},
            {label: "vet1_name", name:"vet1_name"},
            {label: "vet1_specialty", name:"vet1_specialty"},
            {label: "vet1_address", name:"vet1_address"},
            {label: "vet1_city", name:"vet1_city"},
            {label: "vet1_state", name:"vet1_state"},
            {label: "vet1_zip", name:"vet1_zip"},
            {label: "vet1_phone", name:"vet1_phone"},
            {label: "vet1_email", name:"vet1_email"},
            {label: "vet1_fax", name:"vet1_fax"},
            {label: "vet2_name", name:"vet2_name"},
            {label: "vet2_specialty", name:"vet2_specialty"},
            {label: "vet2_address", name: "vet2_address"} ,
            {label: "vet2_city", name:"vet2_city"},
            {label: "vet2_state", name:"vet2_state"},
            {label: "vet2_zip", name:"vet2_zip"},
            {label: "vet2_phone", name:"vet2_phone"},
            {label: "vet2_email", name:"vet2_email"},
            {label: "vet2_fax", name:"vet2_fax"},
            {label: "createdAt", name:"createdAt"},
            {label: "updatedAt", name:"updatedAt"}
        ]
    } );

    
$('#petsDash').on( 'click', 'tbody td:not(:first-child)', function (e) {
        editor.bubble( this );
    } );

    var table = $('#petsDash').DataTable( {
        ajax: {
            url:'/api/pet',
            dataSrc:''
        },
        dom: 'Bfrtip',
        columns: [
            {
                data: null,
                defaultContent: '',
                className: 'select-checkbox',
                orderable: false,
                "width": "5%"
            },
            { data: 'id' },
            {data: "ownerId"},
            {data: "pet_name"},
            {data: "pet_type"},
            {data: "pet_breed"},
            {data: "pet_color"},
            {data: "license_no"},
            {data: "microchip_no"},
            {data: "insur_name"},
            {data: "insur_id"},
            {data: "insur_phone"},
            {data: "pet_dob"},
            {data: "pet_dod"},
            {data: "pet_age"},
            {data: "pet_sex"},
            {data: "spayed_neutered_ind"},
            {data: "pet_image_url"},
            {data: "cond1"},
            {data: "cond2"},
            {data: "cond3"},
            {data: "med1"},
            {data: "med2"},
            {data: "med3"},
            {data: "vet1_name"},
            {data: "vet1_specialty"},
            {data: "vet1_address"},
            {data: "vet1_city"},
            {data: "vet1_state"},
            {data: "vet1_zip"},
            {data: "vet1_phone"},
            {data: "vet1_email"},
            {data: "vet1_fax"},
            {data: "vet2_name"},
            {data: "vet2_specialty"},
            {data: "vet2_address"},
            {data: "vet2_city"},
            {data: "vet2_state"},
            {data: "vet2_zip"},
            {data: "vet2_phone"},
            {data: "vet2_email"},
            {data: "vet2_fax"},
            {data: "createdAt"},
            {data: "updatedAt"},
            {
                data: null,
                className: "center",
                defaultContent: '<a href="" class="editor_edit">Edit</a> / <a href="" class="editor_remove">Delete</a>'
            }
            // etc
        ],
        select: true,
        select: {
            style:    'multi',
            selector: 'td:first-child'
        },
        "scrollX": true,
        buttons: [
            { extend: 'create', editor: editor,  },
            { extend: 'edit',   editor: editor },
            { extend: 'remove', editor: editor },
            {
                text: 'Select All',
                action: function () {
                table.rows( {search:'applied'} ).select();
                }
            },
            'selectNone'
        ]
    } );

    // Edit record
    $('#petsDash').on('click', 'a.editor_edit', function (e) {
        e.preventDefault();
 
        editor.edit( $(this).closest('tr'), {
            title: 'Edit record',
            buttons: 'Update'
        } );
    } );
 
    // Delete a record
     $('#petsDash').on('click', 'a.editor_remove', function (e) {
        e.preventDefault();
 
        editor.remove( $(this).closest('tr'), {
            title: 'Delete record',
            message: 'Are you sure you wish to remove this record?',
            buttons: 'remove'
        } );
    } );
     
    //disable field on edit
    editor.on( 'onInitEdit', function () {
          editor.disable('id');
    } );
    //disable field on edit
    editor.on( 'onInitCreate', function () {
          editor.disable('id');
    } );
} );

</script>
{{/section}}